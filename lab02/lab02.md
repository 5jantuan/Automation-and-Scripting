# Автоматизация получения курсов валют

Этот лабораторный проект добавляет небольшую утилиту командной строки (CLI), которая взаимодействует с сервисом поддержки `lab02/lab02prep`. Скрипт запрашивает курс валют на указанную дату, сохраняет JSON-ответ и логирует ошибки.

## Требования

- **Python** 3.12 или новее
- **pip** для установки зависимостей Python

## Установка зависимостей Python

```sh
pip install --upgrade requests
```

## Запуск локального сервиса (опционально)

Если вы хотите использовать локальный API, выполните:

```sh
cd lab02\lab02prep
copy sample.env .env  
set EXCHANGE_API_KEY=12345
docker-compose up --build
```

Сервис будет доступен по адресу [http://localhost:8080/](http://localhost:8080/) после запуска контейнеров.

## Запуск скрипта

Из корневой директории проекта:

```sh
python lab02\currency_exchange_rate.py USD EUR 2025-01-01 --api-key %EXCHANGE_API_KEY%
```

## Сохранение результатов

Успешные запросы сохраняют JSON-файлы в папку:

```
data\<FROM>_<TO>_<DATE>.json
```

## Обработка ошибок

Если сервис вернёт ошибку или запрос не удастся, причина будет выведена в консоль и добавлена в `error.log` в корне проекта.

## Структура скрипта

- **parse_args** – обработка параметров командной строки, включая опциональные переопределения.
- **validate_inputs** – нормализация кодов валют, проверка формата даты, определение URL сервиса и ключа API.
- **fetch_exchange_rate** – выполнение HTTP POST-запроса (параметры в query string, ключ в теле запроса) и проверка ответа.
- **save_response** – создание папки `data/` при необходимости и сохранение JSON-ответа.
- **log_error** – запись ошибок в `error.log` с отметкой времени UTC.
- **main** – объединяет разбор аргументов, проверку, сетевой запрос, сохранение данных и вывод пользователю.
