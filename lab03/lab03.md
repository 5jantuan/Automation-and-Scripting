# Lab03 – Автоматизация скрипта currency_exchange_rate.py с помощью Cron в Docker

## Обзор

Проект расширяет лабораторную работу Lab02. Скрипт `currency_exchange_rate.py` автоматически выполняется с помощью cron внутри Docker-контейнера. Скрипт получает курсы валют для заданных дат и сохраняет данные в формате JSON. Автоматизация настроена на ежедневные и еженедельные задачи.

---

## Структура проекта
```
lab03/
├── currency_exchange_rate.py # Python-скрипт для получения курса валют
├── cronjob # Определение cron-задач
├── entrypoint.sh # Скрипт запуска cron и мониторинга логов
├── Dockerfile # Описание Docker-образа
├── docker-compose.yml # Compose-файл для сборки и запуска контейнера
└── README.md # Этот файл
```


**Описание файлов:**

- **currency_exchange_rate.py** – Скрипт, который принимает аргументы командной строки `currency_from`, `currency_to`, `date`. Получает курс валют и сохраняет его в JSON-файл в папку `data/`.
- **cronjob** – Файл с задачами cron:
  - Ежедневно в 6:00 утра: курс MDL → EUR за предыдущий день.
  - Еженедельно в пятницу в 17:00: курс MDL → USD за предыдущую неделю.
- **entrypoint.sh** – Создает файл лога `/var/log/cron.log`, мониторит его и запускает cron в фоне.
- **Dockerfile** – Создает образ с Python и cron, копирует все необходимые файлы, добавляет задачи cron.
- **docker-compose.yml** – Собирает и запускает контейнер на основе Dockerfile.

---

## Как собрать и запустить контейнер

1. Открыть терминал в директории `lab03`.
2. Собрать Docker-образ:
```
docker-compose build
```

Запустить контейнер в фоне:

```
docker-compose up -d
```
Как проверить выполнение cron-задач
Проверить, что контейнер работает:

```
docker ps
```

Просмотреть лог cron:

```
docker exec -it currency-exchange tail -f /var/log/cron.log
```
В логе должны появляться сообщения о запуске скрипта и успешном сохранении JSON-файлов:

```
Fetching MDL → EUR exchange rate for 2025-10-11
Data saved to /app/data/MDL_EUR_2025-10-11.json
```
В cronejob также добавлена строчка:

```
* * * * * echo 'Cron works $(date)' >> /var/log/cron.log 2>&1
```
Сообщение о том что cronjob работает корректно будет отображаться каждую минуту в логах

Если скрипт сталкивается с ошибкой, она также будет записана в лог.


